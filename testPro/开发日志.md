# 开发日志

## 修改vpn本地pac文件加速github

添加规则

	"||github.com",  
	".github*.com", 

## Tesseract 图片识别

下载
- python要使用tesseract需要在本地安装tesseract-ocr软件
- 软件正常使用需要下载中文训练数据chi_sim.traineddata
- pycharm中找不到tesseract位置，自己指定一下pytesseract.pytesseract.tesseract_cmd = ""
- tesseract 可以再训练

参考文档
- 入门文档 https://tesseract-ocr.github.io/tessdoc/#usage
- 数字处理 https://stackoverflow.com/questions/44619077/pytesseract-ocr-multiple-config-options

基础模型的使用
- 对正规书写的中文识别效果不错，参考“静夜思.png”
- 对电脑随手截图的文本识别效果不错，参考“知乎截图”，但对超文本的识别有小问题，因为会识别到超文本的角标
- 对数字识别并不理想，优化：
  - 对识别内容进行定义：config='--psm 7 --oem 3 -c tessedit_char_whitelist=0123456789'
  - 做二值化
  - 阈值220-230在'7364'这图都是可以的，但向上240二值化直接失真，向下210肉眼来看很清晰但识别错误
  - 看起来调参也是麻烦的工作
- 图片大小对识别也有影响，'2710386495.png'太细长了，识别出来是别的数字，但我截图扩大图片大小，就能准确识别了，估计模型是对边框大小有处理 

结论：
- 看起来标准字符识别效果是可信的，不用自己训练（成本也太高了），更多情况下是对图片进行处理，对识别引擎进行配置上的特化

扩展
- 重新训练Tesseract只在不同的字体、书写方法、新语言等情况下好用，图片质量导致的问题使用的是另一套解决方案
- 文档里描述了提高图片质量的方法，降噪、二值化、旋转等，看起来很强大

## 千千音乐

模拟接口获取歌曲详情 （包含曲目直链，vip为试听）
- 接口示例: https://music.taihe.com/v1/song/tracklink?sign=9e8e4a3e4c549b5a7fa599fada33c081&appid=16073360&TSID=T10038997741&timestamp=1639294994
- 直链示例: https://audio04.dmhmusic.com/71_53_T10038997741_128_4_1_0_sdk-cpm/cn/0209/M00/BF/07/ChR46118VuyAeJqFAEBONt6RaVw155.mp3?xcode=2fbc92c93f75955b94ddd360a68ed1a152d5a4f
  - 推测：直链xcode是关于过期时间的函数
- vip歌曲 只能拿到trail_video_path字段进行试听30s
- sign是 {TSID，appid，timestamp}的md5加密
  - js:   https://static1-music.taihe.com/client/d5af576a97f645599a5f.js
  ![image.png](http://tva1.sinaimg.cn/large/006fuBezly1gxb5fgeeayj31d209jajv.jpg)